<?php 
    session_start();
    require_once '../DBManager/DBAccess.php';
    $cls = new DBAccess();
    $selectArray = $cls->SelectForumCategoryTbl();
    $selectData = $cls->SelectForumDetailByid($_POST['forum_id']);
?>

<!DOCTYPE html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="manifest" href="../manifest.json">
        <link rel="stylesheet" href="./css/ForumPost.css">
        <script src="js/ForumPost.js"></script> <!-- SignUp.js ファイルを読み込む -->
    </head>
    <body>
        <!-- ↓ ヘッダー読み込み ↓ -->
        <?php include("../Common/Header.html");?>
        <!-- ↑ ヘッダー読み込み ↑ -->
        <form action="php/ForumUpdate.php" method="post" name="myForm" onsubmit="return validateForm()">
            <?php 
                foreach($selectData as $row){
                echo '<input type="hidden" name="user_id" value="'.$_SESSION['user_id'].'">';
                echo '<input type="hidden" name="forum_id" value="'.$row['forum_id'].'">';
            ?>
            <input type="text" name="title" value="<?php echo $row['title'];?>"><br>
            <textarea name="post_content" id="content"><?php echo $row['post_content'];?></textarea><br>
            <select name="for_cate_code">
            <?php
            $selectCategory = $row['forum_category_code'];
            foreach($selectArray as $row){
		        if($selectCategory == $row['forum_category_code']){
			        echo '<option value="'.$row['forum_category_code'].'" selected>'.$row['category_name'].'</option>';
		        }else{
			        echo '<option value="'.$row['forum_category_code'].'">'.$row['category_name'].'</option>';
                }
		    }
            ?>
            </select>
            <select name="building_num">
                <option value="<?php echo $row['building_number'];?>" hidden>号館</option>
                <option value="1">１号館</option>
                <option value="2">2号館</option>
                <option value="3">３号館</option>
            </select>
            <br>
            <div id="errMsg"></div>
            <input type="submit" value="登録" id="btn">
        </form>
        <a href="../Profile/Profile.html" id="backbtn">戻る</a>
        <?php 
        }
        ?>
        <!-- ↓ フッター読み込み ↓ -->
        <?php include("../Common/Footer.html");?>
        <!-- ↑ フッター読み込み ↑ -->
    </body>
</html>