<?php 
    require_once '../DBManager/DBAccess.php';
    $cls = new DBAccess();
    $selectArray = $cls->SelectSchoolTbl();
    $selectData = $cls->SelectUserTblByMail($_POST['mail']);
    if(!empty($selectData)){
        $errMsg="すでに使用されているメールアドレスです。";
        header('Location:SignUp.html?errMsg='.$errMsg);
        exit;
    }
?>

<!DOCTYPE html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <script src="js/SignUp.js"></script> <!-- SignUp.js ファイルを読み込む -->
    </head>
    <body>
        
        <form action="php/UserInsert.php" method="post" name="myForm" onsubmit="return validateForm2()">
            <?php 
                echo '<input type="hidden" name="mail" value="'.$_POST['mail'].'">';
                echo '<input type="hidden" name="password" value="'.$_POST['password'].'">';
            ?>
            <input type="text" name="user_name" placeholder="ユーザー名"><br>
            <input type="text" name="major" placeholder="専攻"><br>
            <select name="school_code">
                <option value="null" hidden>学校名</option>
                <?php
                foreach($selectArray as $row){
                    echo '<option value="'.$row['school_code'].'">'.$row['school_name'].'</option>';
                }
            ?>
            </select>
            <select name="gender">
                <option value="null" hidden>性別</option>
                <option value="1">男</option>
                <option value="2">女</option>
                <option value="3">その他</option>
            </select>
            <br>
            <select name="school_year">
                <option value="null" hidden>学年</option>
                <optgroup label="4年制">
                    <option value="4年制1年">1</option>
                    <option value="4年制2年">2</option>
                    <option value="4年制3年">3</option>
                    <option value="4年制4年">4</option>
                </optgroup>
                <optgroup label="3年制">
                    <option value="3年制1年">1</option>
                    <option value="3年制2年">2</option>
                    <option value="3年制3年">3</option>
                </optgroup>
                <optgroup label="2年制">
                    <option value="2年制1年">1</option>
                    <option value="2年制2年">2</option>
                </optgroup>
            </select>
            <br>
            <input type="submit" value="登録">
        </form>
        <a href="SignUp.html">戻る</a>
        <div id="errMsg"></div>
    </body>
</html>